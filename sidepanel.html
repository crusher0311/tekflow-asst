<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TekFlow Assistant</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Authentication Required Overlay -->
    <div id="auth-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; justify-content: center; align-items: center;">
        <div style="background: var(--bg-primary); padding: 30px; border-radius: var(--radius-lg); max-width: 400px; text-align: center;">
            <h2 style="color: var(--text-primary); margin-bottom: 16px;">üîê Authentication Required</h2>
            <p style="color: var(--text-secondary); margin-bottom: 24px;">Please sign in to access TekFlow Assistant</p>
            <button id="showAuthButton" style="background-color: var(--accent-blue); color: white; border: none; padding: 12px 24px; border-radius: var(--radius); font-size: 16px; cursor: pointer;">Sign In / Register</button>
        </div>
    </div>

    <!-- Subscription Banner -->
    <div id="subscription-banner" style="display: none; background: linear-gradient(135deg, #f59e0b, #d97706); color: white; padding: 12px 16px; text-align: center; font-size: 14px; font-weight: 500;">
        <span id="subscription-message">üéÅ Free Trial Active - 0 days remaining</span>
        <button id="upgradeButton" style="background: white; color: #d97706; border: none; padding: 4px 12px; border-radius: 4px; margin-left: 12px; font-size: 12px; cursor: pointer;">Upgrade Now</button>
    </div>

    <!-- User Header -->
    <div id="user-header" style="display: none; background: var(--bg-secondary); border-bottom: 1px solid var(--border-color); padding: 12px 16px; display: flex; justify-content: space-between; align-items: center;">
        <div>
            <span id="user-name" style="color: var(--text-primary); font-weight: 500; font-size: 14px;">Welcome, User</span>
            <span id="user-status" style="color: var(--text-secondary); font-size: 12px; margin-left: 8px;">(Pro)</span>
        </div>
        <div>
            <button id="settingsButton" style="background: none; border: none; color: var(--text-secondary); cursor: pointer; padding: 4px; margin-right: 8px;">‚öôÔ∏è</button>
            <button id="logoutButton" style="background: none; border: none; color: var(--text-secondary); cursor: pointer; font-size: 12px;">Logout</button>
        </div>
    </div>

    <div id="extension-content">
        <!-- Logo Section -->
        <div id="logo-container">
            <img src="images/logo.png" alt="TekFlow Assistant" id="logo">
            <h1>TekFlow Assistant</h1>
            <div class="button-container" style="margin-top: 10px; display: flex; justify-content: center;">
                <button id="openPromiseDashboardButton" style="background-color: var(--accent-blue); color: white; padding: 6px 12px; font-size: 12px; border-radius: 4px; width: auto !important; display: inline-flex; align-items: center; gap: 6px; flex-shrink: 0;">‚è∞ Promise Times</button>
            </div>
        </div>

        <!-- Customer Concern Input Section -->
        <div class="section-card" id="customer-concern-section">
            <h2>Customer Concern</h2>
            <textarea id="concernInput" placeholder="Type customer concern..."></textarea>
            <div class="button-container">
                <button id="submitConcernButton">Submit</button>
                <button id="clearFormButton">Clear</button>
            </div>
        </div>

        <!-- Promise Time Monitor Section -->
        <div class="section-card" id="promise-time-monitor" style="display: none;">
            <h2>‚è∞ Promise Time Monitor</h2>
            <div id="promiseTimeInfo">
                <p><strong>Customer:</strong> <span id="ptCustomerName">-</span></p>
                <p><strong>Vehicle:</strong> <span id="ptVehicle">-</span></p>
                <p><strong>Time Remaining:</strong> <span id="ptTimeRemaining">-</span></p>
                <div class="button-container">
                    <button id="openRepairOrderButton" style="display: none;">Open Repair Order</button>
                </div>
            </div>
        </div>

        <!-- Follow-Up Questions Section -->
        <div class="section-card" id="followUpListSection">
            <h2>Follow-Up Questions</h2>
            <div id="followUpList"></div>
        </div>

        <!-- Review and Actions Section -->
        <div class="section-card">
            <div class="button-container">
                <button id="submitForReviewButton">Submit for Review</button>
                <button id="doneButton">Done</button>
            </div>
        </div>

        <!-- Active Conversation Section -->
        <div class="section-card" id="activeConversationSection">
            <h2>Active Conversation</h2>
            <div id="activeConversation"></div>
            <div class="button-container">
                <button id="copyConversationButton">Copy Conversation</button>
                <button id="sendToTekmetricButton">Send To Tekmetric</button>
            </div>
        </div>
    </div>

    <script src="apiClient.js"></script>
    <script type="module" src="popup.js"></script>
    <script src="sidepanel.js"></script>
</body>
</html>
